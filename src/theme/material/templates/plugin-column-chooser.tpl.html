<ng-template key="column-chooser.tpl.html"
             let-$columnChooser>
	<mat-card class="mat-elevation-z">
		<mat-card-header>
			<mat-card-title>Columns Filter</mat-card-title>
		</mat-card-header>
		<mat-card-content>
			<div class="flex-none layout-row">
				<mat-form-field class="q-grid-column-chooser-filter">
					<input type="search"
					       placeholder="Find in the list"
					       matInput
					       [(ngModel)]="$columnChooser.filter"
					       q-grid-focus />
				</mat-form-field>
			</div>
			<div class="flex layout-column">
				<ul class="q-grid-column-chooser-toolbar">
					<li>
						<mat-checkbox [checked]="$columnChooser.stateAll()"
						              (change)="$columnChooser.toggleAll.execute()"
						              [indeterminate]="$columnChooser.isIndeterminate()">
							Select All
						</mat-checkbox>
					</li>
					<li>
						<mat-checkbox [checked]="$columnChooser.stateDefault()"
						              (change)="$columnChooser.defaults.execute()">
							Select Defaults
						</mat-checkbox>
					</li>
				</ul>
				<div class="q-grid-column-chooser-list">
					<ng-container key="column-chooser-node.tpl.html"
					              [context]="{$implicit: $columnChooser, node: $columnChooser.tree}">
					</ng-container>
				</div>
			</div>
		</mat-card-content>
		<mat-card-actions>
			<button mat-button
			        (click)="$columnChooser.cancel.execute()">
				Cancel
			</button>
			<button mat-button
			        color="primary"
			        (click)="$columnChooser.submit.execute()">
				Apply
			</button>
		</mat-card-actions>
	</mat-card>
</ng-template>

<ng-template key="column-chooser-node.tpl.html"
             let-$columnChooser
             let-$parent="node">
	<ul>
		<ng-container *ngFor="let node of $parent.children | qGridFilter: {'key.title': $columnChooser.filter}">
			<li *ngIf="$columnChooser.toggle.canExecute(node)"
			    [q-grid-drop]="$columnChooser.drop"
			    [q-grid-drop-data]="node"
			    [q-grid-drag-over]="$columnChooser.drop"
			    q-grid-drop-area="column-chooser"
			    q-grid-drag-direction="y">
				<div [q-grid-drag]="$columnChooser.drag"
				     [q-grid-drag-data]="node"
				     q-grid-drop-area="column-chooser">
					<mat-icon class="q-grid-icon">drag_indicator</mat-icon>
				</div>
				<mat-checkbox [checked]="$columnChooser.state(node)"
				              (change)="$columnChooser.toggle.execute(node)"
				              aria-label="Selection">
					<span [innerHTML]="node.key.title | qGridHighlight: $columnChooser.filter"></span>
				</mat-checkbox>
			</li>
			<ng-container key="column-chooser-node.tpl.html"
			              [context]="{$implicit: $columnChooser, node: node}">
			</ng-container>
		</ng-container>
	</ul>
</ng-template>